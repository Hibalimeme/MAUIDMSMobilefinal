<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MAUIDMSMobile.Mvvm.Views.DevisPage"
             xmlns:statics="clr-namespace:MAUIDMSMobile.Static"
FlowDirection="{x:Static statics:StaticMultiLang.MLFlowDirection}"
             NavigationPage.HasNavigationBar="False"
             xmlns:resx="clr-namespace:MAUIDMSMobile.Resx"
             xmlns:loc="clr-namespace:LocalizationResourceManager.Maui;assembly=LocalizationResourceManager.Maui"
              BackgroundColor="#80000000"
             x:Name="DevisList"
             Title="{loc:Translate pagedevis}">
    <!--<ContentPage.ToolbarItems>
        <ToolbarItem IconImageSource="logob2m.png" />
    </ContentPage.ToolbarItems>-->
    <ScrollView>
        <Grid>

            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <BoxView Grid.Row="0" HeightRequest="57" VerticalOptions="Start">
                <BoxView.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#f2c08f" Offset="0.1" />
                        <GradientStop Color="#ecb073" Offset="0.7" />
                    </LinearGradientBrush>
                </BoxView.Background>
            </BoxView>
           
                <Label Grid.Row="0"
                          Text="{loc:Translate Devis}"

               FontFamily="Times New Roman"
               FontSize="25"
               TextColor="#df761c"
                FontAttributes="Bold"
               HorizontalOptions="Center"
               VerticalOptions="Center" />

            <BoxView Grid.Row="1" BackgroundColor="#eb8126" HeightRequest="2" HorizontalOptions="Fill" />

            <VerticalStackLayout Grid.Row="2" Padding="10">
                <VerticalStackLayout.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#ffdbad" Offset="0.0" />
                        <GradientStop Color="#f9c27b" Offset="0.6" />
                    </LinearGradientBrush>
                </VerticalStackLayout.Background>

                <!--<ImageButton Source="plus.png"
                         WidthRequest="50"
                         HeightRequest="50"
                         BackgroundColor="#fee4c4"
                         Clicked="OnOpenPopupClicked"
                         Margin="0,10,0,0"
                         HorizontalOptions="Center" 
                         />-->
                <!--<Button Text="devis"
    BackgroundColor="#cd7100" TextColor="White"
    FontAttributes="Bold" WidthRequest="150" HeightRequest="40"
    Margin="-1,12,0,0" FontSize="19"
    Command="{Binding tappedDevisCommand}" />-->
                <ActivityIndicator
                     Grid.Row="3"
      x:Name="activityIndicator"
      IsEnabled="{Binding IsBusy}"
      IsRunning="{Binding IsBusy}"
      IsVisible="{Binding IsBusy}" />
                <CollectionView ItemsSource="{Binding DevisList}" Margin="10,20,0,0">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Border StrokeShape="RoundRectangle 15,15,15,15"
                    BackgroundColor="#fee4c4"
                    Stroke="#954500" 
                    StrokeThickness="1"
                    VerticalOptions="FillAndExpand">
                                <Border.Padding>
                                    <OnIdiom x:TypeArguments="Thickness" Phone="8" Tablet="20" />
                                </Border.Padding>
                                <Border.Margin>
                                    <OnIdiom x:TypeArguments="Thickness" Phone="8" Tablet="10" />
                                </Border.Margin>

                                <VerticalStackLayout>
                                    <!-- NumDevis -->
                                    <Label Margin="10,0,0,0" 
                           HorizontalOptions="StartAndExpand" 
                           VerticalOptions="Center"
                         >
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="{loc:Translate ndevis__}" TextColor="#954500"   FontAttributes="Bold"/>
                                                <Span Text="{Binding NumeroDevis}" TextColor="#954500"   FontAttributes="Bold"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>
                                    <Label Margin="10,0,0,10" FontAttributes="Bold">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="{loc:Translate Statut__}" TextColor="#954500"  FontAttributes="Bold"/>
                                                <Span Text="{Binding Statut}" TextColor="#954500"  FontAttributes="Bold"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>
                                    <Label Margin="10,-11,0,0"
                           HorizontalOptions="StartAndExpand"
                           VerticalOptions="Center"
                           TextColor="#df761c"
                           Text="{loc:Translate Ensavoirplus}"
                                              FontAttributes="Bold" TextDecorations="Underline">

                                        <Label.GestureRecognizers>
                                            <TapGestureRecognizer 
                                Command="{Binding Source={x:Reference DevisList}, Path=BindingContext.VerifierCreneauxTappedCommand}" 
                                CommandParameter="{Binding .}" />
                                        </Label.GestureRecognizers>

                                    </Label> 

                                </VerticalStackLayout>

                            </Border>

                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
        


            </VerticalStackLayout>


        </Grid>
    </ScrollView>
</ContentPage>