<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MAUIDMSMobile.Mvvm.Views.MesVéhiculesPage"
             xmlns:vm="clr-namespace:MAUIDMSMobile.Mvvm.ViewModels"
             xmlns:communityToolkit="clr-namespace:CommunityToolkit.Maui.Views;assembly=CommunityToolkit.Maui"
             xmlns:loc="clr-namespace:LocalizationResourceManager.Maui;assembly=LocalizationResourceManager.Maui"
             Title="{loc:Translate Mesvehicule}"
              NavigationPage.HasNavigationBar="False"
             xmlns:statics="clr-namespace:MAUIDMSMobile.Static"
FlowDirection="{x:Static statics:StaticMultiLang.MLFlowDirection}"
             xmlns:resx="clr-namespace:MAUIDMSMobile.Resx"
             BackgroundColor="White">



    <ScrollView>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <BoxView Grid.Row="0" HeightRequest="57" VerticalOptions="Start">
                <BoxView.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#f2c08f" Offset="0.1" />
                        <GradientStop Color="#ecb073" Offset="0.7" />
                    </LinearGradientBrush>
                </BoxView.Background>
            </BoxView>

            <Label Grid.Row="0"
                   Text="{loc:Translate MenuVehicule}"
                   FontFamily="Times New Roman"
                   FontSize="23"
                   TextColor="#df761c"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"
                   VerticalOptions="Center" />

            <BoxView Grid.Row="1" BackgroundColor="#eb8126" HeightRequest="2" HorizontalOptions="Fill" />

            <VerticalStackLayout Grid.Row="2" Padding="10">
                <VerticalStackLayout.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                        <GradientStop Color="#ffdbad" Offset="0.0" />
                        <GradientStop Color="#f9c27b" Offset="0.6" />
                    </LinearGradientBrush>
                </VerticalStackLayout.Background>

                <ImageButton Source="plus.png"
                             WidthRequest="40"
                             HeightRequest="40"
                             Clicked="OnOpenPopupClicked"
                             Margin="10,0,0,0"
                             HorizontalOptions="Center" />

                <ActivityIndicator x:Name="activityIndicator"
                                   IsEnabled="{Binding IsBusy}"
                                   IsRunning="{Binding IsBusy}"
                                   IsVisible="{Binding IsBusy}" />

                <Label HorizontalOptions="Center"
                       Text="{loc:Translate AttenteValidation}"
                       FontAttributes="Bold"
                       FontSize="19"
                       Margin="0,20,0,10"
                       TextColor="#eb8126" />

                <CollectionView ItemsSource="{Binding VehiculesEnAttente}"
                        
                                ItemsLayout="VerticalList">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame BackgroundColor="#ffe1bc" BorderColor="#954500" CornerRadius="15" Margin="10">
                                <VerticalStackLayout>
                                    <Label Margin="10,0,0,0"
       HorizontalOptions="StartAndExpand" TextColor="#954500"
       VerticalOptions="Center">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="{loc:Translate Marque__}" TextColor="#954500" FontAttributes="Bold"/>
                                                <Span Text="{Binding Marque}" TextColor="#954500" FontAttributes="Bold"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>

                                    <Label Margin="10,0,0,0"
       HorizontalOptions="StartAndExpand"
       VerticalOptions="Center">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="{loc:Translate Modle__}" TextColor="#954500" FontAttributes="Bold"/>
                                                <Span Text="{Binding Model}" TextColor="#954500" FontAttributes="Bold"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>

                                    <Label Margin="10,0,0,0"
       HorizontalOptions="StartAndExpand"
       VerticalOptions="Center">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="{loc:Translate Numchass__}" TextColor="#954500" FontAttributes="Bold"/>
                                                <Span Text="{Binding NumChassis}" TextColor="#954500" FontAttributes="Bold"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>

                                    <Label Margin="10,0,0,0"
       HorizontalOptions="StartAndExpand"
       VerticalOptions="Center">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="{loc:Translate DateHeure__}" TextColor="#954500" FontAttributes="Bold"/>
                                                <Span Text="{Binding DateMiseEnCirculation, StringFormat='{0:d}'}" TextColor="#954500" FontAttributes="Bold"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>

                                    <Label Margin="10,0,0,0"
       HorizontalOptions="StartAndExpand"
       VerticalOptions="Center">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="{loc:Translate Immatriculation__}" TextColor="#954500" FontAttributes="Bold"/>
                                                <Span Text="{Binding Immatriculation}" TextColor="#954500" FontAttributes="Bold"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>

                                </VerticalStackLayout>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

                <Label Text="{loc:Translate VéhiculesValidés}"
                       FontAttributes="Bold"
                       FontSize="19"
                       Margin="0,10"
                       TextColor="#eb8126"
                       HorizontalOptions="Center" />

                <CollectionView ItemsSource="{Binding VehiculesValides}"
                                RemainingItemsThreshold="2"
                                RemainingItemsThresholdReachedCommand="{Binding LoadMoreValidatedVehiclesCommand}"
                               
                                ItemsLayout="VerticalList">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame BackgroundColor="#ffe1bc" BorderColor="#954500" CornerRadius="15" Margin="10">
                                <VerticalStackLayout>
                                    <Label Margin="10,0,0,0"
HorizontalOptions="StartAndExpand"
VerticalOptions="Center">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="{loc:Translate Marque__}" TextColor="#954500" FontAttributes="Bold"/>
                                                <Span Text="{Binding Marque}" TextColor="#954500" FontAttributes="Bold"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>

                                    <Label Margin="10,0,0,0"
HorizontalOptions="StartAndExpand"
VerticalOptions="Center">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="{loc:Translate Modle__}" TextColor="#954500" FontAttributes="Bold"/>
                                                <Span Text="{Binding Model}" TextColor="#954500" FontAttributes="Bold"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>

                                    <Label Margin="10,0,0,0"
HorizontalOptions="StartAndExpand"
VerticalOptions="Center">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="{loc:Translate Numchass__}" TextColor="#954500" FontAttributes="Bold"/>
                                                <Span Text="{Binding NumChassis}" TextColor="#954500" FontAttributes="Bold"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>

                                    <Label Margin="10,0,0,0"
HorizontalOptions="StartAndExpand"
VerticalOptions="Center">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="{loc:Translate DateHeure__}" TextColor="#954500" FontAttributes="Bold"/>
                                                <Span Text="{Binding DateMiseEnCirculation, StringFormat='{0:d}'}" TextColor="#954500" FontAttributes="Bold"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>

                                    <Label Margin="10,0,0,0"
HorizontalOptions="StartAndExpand"
VerticalOptions="Center">
                                        <Label.FormattedText>
                                            <FormattedString>
                                                <Span Text="{loc:Translate Immatriculation__}" TextColor="#954500" FontAttributes="Bold"/>
                                                <Span Text="{Binding Immatriculation}" TextColor="#954500" FontAttributes="Bold"/>
                                            </FormattedString>
                                        </Label.FormattedText>
                                    </Label>

                                </VerticalStackLayout>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
        </Grid>
    </ScrollView>
</ContentPage>
